---
import HeroCapabilityConsulting from "@/components/HeroCapabilityConsulting.astro";
import Layout from "../layouts/Layout.astro";

import {
  ADSCLICK,
  AUTOMATION,
  CHATBUBBLE,
  LOGOMARK,
  HERO_LEARNING_EXPERIENCE_PLATFORM,
  LEARNING_IMAGE1,
  LEARNING_IMAGE2,
  LEARNING_IMAGE3,
  COLLABORATION,
  STAR,
  FORUM,
  SEARCHINSIGHTS,
  ADSCLICK2,
  TACTIC
} from "@/consts";
import ContactUsMiniCards from "@/components/ContactUsMiniCards.astro";
import { Image } from "astro:assets";



const whyChooseUsData = [
  {
    title: "Experience Experts",
    content:
      "With decades of consulting experience, we understand the complexities of your SDV transformation. We craft tailored strategies to help you overcome these challenges with precision, ensuring you stay on track every step of the way.",
  },
  {
    title: "Proven Approaches", 
    content:
      "With decades of consulting experience, we understand the complexities of your SDV transformation. We craft tailored strategies to help you overcome these challenges with precision, ensuring you stay on track every step of the way.",
  },
  {
    title: "Flexible Implementation",
    content:
      "With decades of consulting experience, we understand the complexities of your SDV transformation. We craft tailored strategies to help you overcome these challenges with precision, ensuring you stay on track every step of the way.",
  },
  {
    title: "Building Internal Strength",
    content:
      "With decades of consulting experience, we understand the complexities of your SDV transformation. We craft tailored strategies to help you overcome these challenges with precision, ensuring you stay on track every step of the way.",
  },
];

const uniqueId = `why-choose-us-${Math.random().toString(36).substr(2, 9)}`;
---

<Layout>
  <HeroCapabilityConsulting
    content="Empowering innovators to lead in the AI-driven future of automotive R&D."
    image={HERO_LEARNING_EXPERIENCE_PLATFORM}
  />


<section
  class="px-4 sm:px-8 md:px-16 lg:px-44 xl:px-56 py-16 md:py-24 space-y-16"
  data-animation-section={uniqueId}
>

  <!-- Content Section -->
  <div class="flex flex-col lg:flex-row gap-12">


 <div class="w-full lg:w-1/2">
  <p class="text-[#002166] text-2xl sm:text-xl md:text-5xl max-w-xl font-semibold">Overcoming Key Challenges in the SDV Transformation Journey</p>
</div>

    <div class="w-full lg:w-1/2 space-y-8" data-hover-container={uniqueId}>
      <div class="flex flex-col gap-4 h-[20rem]" data-sections-container={uniqueId}>
        {
            whyChooseUsData.map((item, index) => (
              <div class="section flex items-start gap-4 opacity-50 transition-opacity duration-500 cursor-pointer" data-section={index} data-clickable-section={index}>
                <!-- Progress Bar -->
                <div class="relative w-1 flex-shrink-0 h-auto" data-bar>
                  <div class="bg-[#d2e1ff] rounded-full w-full" data-bar-bg></div>
                  <div
                    class="bg-[#002166] rounded-full w-full absolute left-0 top-0"
                    data-progress
                  ></div>
                </div>
  
                <!-- Text -->
                <div>
                  <h3 class="font-bold text-[#002166] text-lg sm:text-xl md:text-2xl" data-title>
                    {item.title}
                  </h3>
                  <p
                    class="text-[#4c5967] text-base sm:text-lg max-h-0 opacity-0 overflow-hidden transition-all duration-700 ease-in-out"
                    data-description
                  >
                    {item.content}
                  </p>
                </div>
              </div>
            ))
          }
      </div>
    </div>

   
  </div>
</section>



<section
class="h-full px-4 sm:px-8 md:px-16 lg:px-28 xl:px-[14rem] bg-white mb-16"
>
<!-- Sticky Title Block -->
<div class="relative">
  <div
    class="sticky top-[5rem] bg-white z-20 py-0 pt-2 md:py-4 mb-8"
  >
    <span class="text-blue-600 text-xl">Our Expertise</span>
    <h2
      class="text-[#002166] text-2xl sm:text-xl md:text-5xl font-semibold max-w-5xl"
    >
    Getting you ready for success through our own experience
    </h2>
  </div>

      <div
        class="sticky top-[10rem] space-y-[2rem]"
      >
        <!-- CARD 1 -->
        <div
          class="bg-[#1A49AD] w-full rounded-2xl pl-0 md:flex justify-between gap-8 sticky min-h-max top-[13rem] md:top-[15rem] z-[1] overflow-hidden"
        >
          <!-- Left Text Block -->
          <div class="max-w-2xl z-10 flex flex-col justify-start p-8 w-full md:w-[50%]">
            <h3 class="text-lg sm:text-2xl md:text-2xl lg:text-2xl xl:text-2xl 2xl:text-3xl font-semibold text-white max-w-[23rem] mb-4">
              Transformation Management Office
            </h3>
            <p class="mt-2 text-white text-md sm:text-sm md:text-sm lg:text-sm xl:text-sm 2xl:text-lg max-w-[27rem]">
              We help you shape your SDV transformation based on where you are today by building tailored use cases, aligning roles across leaders and teams, and creating a clear roadmap. By Integrating AI-powered tools, we boost how your organisation designs, develops, and tests—so you move faster and smarter across the board.​
            </p>
          </div>

          <!-- Right Image Section -->
          <div
            class="relative w-full md:w-[50%] flex justify-end items-center mt-6 md:mt-0"
          >
            <div class="w-full h-full aspect-video">
              <Image
                src={LEARNING_IMAGE1}
                alt="Workflow UI Preview"
                class="w-full h-full object-cover"
              />
            </div>
          </div>
        </div>

        <!-- CARD 2 -->
        <div
          class="bg-[#1563ff] w-[100%] rounded-2xl pl-0 md:flex justify-between gap-8 sticky min-h-max top-[15rem] md:top-[17rem] z-[2] overflow-hidden"
        >
        <div class="max-w-2xl z-10 flex flex-col justify-start  p-8 w-full md:w-[50%]">
            <h3 class="text-lg sm:text-2xl md:text-2xl lg:text-2xl xl:text-2xl 2xl:text-3xl font-semibold text-white max-w-[23rem] mb-4">
              Insights & Capability Building​
            </h3>
            <p class="mt-2 text-white text-md sm:text-sm md:text-sm lg:text-sm xl:text-sm 2xl:text-lg  max-w-[27rem]">
              We identify gaps across your skills, tools, and tech—then bridge them, whether through internal growth or external acquisions. Our AI-enhanced insights guide better decisions around suppliers, roles, and use cases—so you're investing in capabilities that truly accelerate your SDV journey.​
            </p>
          </div>
          <div
            class="relative w-full md:w-[50%] flex justify-end items-center mt-6 md:mt-0"
          >
            <div class="w-full h-full aspect-video">
              <Image
                src={LEARNING_IMAGE2}
                alt="Workflow UI Preview"
                class="w-full h-full object-cover"
              />
            </div>
          </div>
        </div>

        <!-- CARD 3 -->
        <div
          class="bg-[#013399] w-full rounded-2xl pl-0 md:flex justify-between gap-8 sticky min-h-max top-[17rem] md:top-[19rem] z-[3] overflow-hidden"
        >
        <div class="max-w-2xl z-10 flex flex-col justify-start p-8 w-full md:w-[50%]">
            <h3 class="text-lg sm:text-2xl md:text-2xl lg:text-2xl xl:text-2xl 2xl:text-3xl font-semibold text-white max-w-[23rem] mb-4">
              Competence Development Consulting​
            </h3>
            <p class="mt-2 text-white text-md sm:text-sm md:text-sm lg:text-sm xl:text-sm 2xl:text-lg  max-w-[27rem]">
              We can help the companies to validate the reference architecture, help to implement the processes like DevOps, CI/CD, DataOps, and AI tools.
            </p>
            <p class="mt-2 text-white text-md sm:text-sm md:text-sm lg:text-sm xl:text-sm 2xl:text-lg  max-w-[27rem]">
              How to move to cloud to build clone to perform virtual design and testing. How to improve the security architecture.
            </p>
          </div>
          <div
            class="relative w-full md:w-[50%] flex justify-end items-center mt-6 md:mt-0"
          >
            <div class="w-full h-full aspect-video">
              <Image
                src={LEARNING_IMAGE3}
                alt="Workflow UI Preview"
                class="w-full h-full object-cover"
              />
            </div>
          </div>
        </div>

        <div
          class="w-full sticky min-h-[5rem] top-[19rem] z-[1] overflow-hidden"
        > </div>
      </div>
    </div>
  </section>
  

  <section class="px-4 sm:px-8 md:px-16 lg:px-44 xl:px-56 bg-[#f6f9ff] py-12 h-full mb-24 ">
    <!-- Begin Sticky Scroll Section -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 relative">
        <!-- Left Sticky Image -->
        <div class="relative h-full">
            <div class="sticky top-[9rem]">
                <div class="flex flex-col gap-2 mb-6">
                    <span class="text-blue-600 text-xl">Our Process</span>
                    <h2 class="text-[#002166] text-2xl sm:text-xl md:text-3xl lg:text-5xl font-semibold max-w-md mb-6 text-left">
                        This is how our collaboration works
                    </h2>
                </div>
                
                <!-- Placeholder for collaboration image -->
                <Image src={COLLABORATION} alt="Collaboration Image" class="hidden md:block w-full max-w-[35rem] object-contain rounded-2xl" />
            </div>
        </div>

        <!-- Right Content -->
        <div class="flex flex-col gap-12 text-[#1563FF] max-w-md pt-0 md:pt-24">
            <!-- Step 1 -->
            <div class="flex gap-4">
                <div class="flex-shrink-0 z-10">
                    <div class="w-12 h-12 bg-[#ffb700] rounded-full flex items-center justify-center">
                        <Image src={FORUM} alt="Step 1 Image" class="w-6 h-6 object-contain z-20" />
                    </div>
                </div>
                <div class="flex flex-col gap-2">
                    <div class="flex flex-col gap-1">
                        <span class="text-[#002166] text-lg font-semibold">Step 1:</span>
                        <h3 class="text-[#002166] font-bold text-2xl">
                            Let's Get Aligned
                        </h3>
                    </div>
                    <p class="text-lg leading-relaxed text-[#4c5967]">
                        We start by understanding your strategic vision and where your product is headed. This ensures everything we do supports your long-term goals and innovation plans from day one.
                    </p>
                </div>
            </div>

            <!-- Step 2 -->
            <div class="flex gap-4">
                <div class="flex-shrink-0 z-10">
                    <div class="w-12 h-12 bg-[#ffb700] rounded-full flex items-center justify-center">
                        <Image src={SEARCHINSIGHTS} alt="Step 1 Image" class="w-6 h-6 object-contain z-20" />
                    </div>
                </div>
                <div class="flex flex-col gap-2">
                    <div class="flex flex-col gap-1">
                        <span class="text-[#002166] text-lg font-semibold">Step 2:</span>
                        <h3 class="text-[#002166] font-bold text-2xl">
                            Diagnose the Now
                        </h3>
                    </div>
                    <p class="text-lg leading-relaxed text-[#4c5967]">
                        Through a detailed assessment, we map out your current SDV maturity, team skillsets, and product environment—building a clear picture of where you are and where you need to go.
                    </p>
                </div>
            </div>

            <!-- Step 3 -->
            <div class="flex gap-4">
                <div class="flex-shrink-0 z-10">
                    <div class="w-12 h-12 bg-[#ffb700] rounded-full flex items-center justify-center">
                        <Image src={ADSCLICK2} alt="Step 1 Image" class="w-6 h-6 object-contain z-20" />
                    </div>
                </div>
                <div class="flex flex-col gap-2">
                    <div class="flex flex-col gap-1">
                        <span class="text-[#002166] text-lg font-semibold">Step 3:</span>
                        <h3 class="text-[#002166] font-bold text-2xl">
                            Define the Focus
                        </h3>
                    </div>
                    <p class="text-lg leading-relaxed text-[#4c5967]">
                        Together, we pinpoint the areas where we can make the biggest impact. It's all about finding the levers that will accelerate your SDV transformation most effectively.
                    </p>
                </div>
            </div>

            <!-- Step 4 -->
            <div class="flex gap-4">
                <div class="flex-shrink-0 z-10">
                    <div class="w-12 h-12 bg-[#ffb700] rounded-full flex items-center justify-center">
                        <Image src={STAR} alt="Step 1 Image" class="w-6 h-6 object-contain z-20" />
                    </div>
                </div>
                <div class="flex flex-col gap-2">
                    <div class="flex flex-col gap-1">
                        <span class="text-[#002166] text-lg font-semibold">Step 4:</span>
                        <h3 class="text-[#002166] font-bold text-2xl">
                            Unlock with AI
                        </h3>
                    </div>
                    <p class="text-lg leading-relaxed text-[#4c5967]">
                        Using our AI-powered tools, we identify the right use cases, key skills, enabling tech, and ideal partners—bringing clarity and precision to every decision.
                    </p>
                </div>
            </div>

            <!-- Step 5 -->
            <div class="flex gap-4">
                <div class="flex-shrink-0 z-10">
                    <div class="w-12 h-12 bg-[#ffb700] rounded-full flex items-center justify-center">
                        <Image src={TACTIC} alt="Step 1 Image" class="w-6 h-6 object-contain " />
                    </div>
                </div>
                <div class="flex flex-col gap-2">
                    <div class="flex flex-col gap-1">
                        <span class="text-[#002166] text-lg font-semibold">Step 5:</span>
                        <h3 class="text-[#002166] font-bold text-2xl">
                            Shift into Gear
                        </h3>
                    </div>
                    <p class="text-lg leading-relaxed text-[#4c5967]">
                        We help launch organizational structures where needed—moving toward a software-first mindset that fosters agility, innovation, and stronger collaboration across teams.
                    </p>
                </div>
            </div>
        </div>

        <hr class="hidden absolute left-0 top-0 border-2 rotate-90 border-[#fff5dd] w-[60rem]" />
    </div>
</section>


  <section
    class="px-4 sm:px-8 md:px-16 lg:px-44 xl:px-56 py-16 md:py-24 space-y-16"
  >
    <!-- Title -->
    <div class="text-center mb-8">
      <span class="text-blue-600 font-medium block text-base sm:text-lg">
        How to Contact Us
      </span>
      <h2
        class="text-[#002166] text-3xl sm:text-4xl md:text-5xl font-bold mt-2"
      >
        Your Path to Success is Set
      </h2>
    </div>

    <!-- Mini Cards -->
    <div class="flex flex-col sm:flex-row justify-between gap-6 mb-6">
      <ContactUsMiniCards
        icon={CHATBUBBLE}
        content="Contact us via contact form"
      />
      <ContactUsMiniCards icon={ADSCLICK} content="Define your needs" />
      <ContactUsMiniCards icon={AUTOMATION} content="Implement the solution" />
    </div>

    <!-- CTA Box -->
    <div
      class="relative bg-blue-600 rounded-2xl text-white px-6 sm:px-12 md:px-14 py-12 sm:py-20 overflow-hidden"
    >
      <div class="flex flex-col gap-4 relative z-10 max-w-xl">
        <span class="text-2xl sm:text-3xl md:text-4xl font-semibold">
          Get in touch with our experts
        </span>
        <span class="text-sm sm:text-base md:text-lg font-light text-[#dce7ff]">
          We can guide you to find the right solution for your needs
        </span>
        <a href="/contact-us">
          <button
            class="bg-white cursor-pointer text-blue-600 w-fit px-6 py-2 rounded-full font-medium hover:bg-gray-100 transition"
          >
            Talk To An Expert
          </button>
        </a>
      </div>

      <!-- Background Logo -->
      <Image
        src={LOGOMARK}
        alt="Logo Mark"
        class="absolute top-0 right-0 w-1/2 h-full opacity-90 mix-blend-overlay pointer-events-none object-cover"
      />
    </div>
  </section>
</Layout>


<script define:vars={{ uniqueId }}>
  (function() {
    const SECTION_ID = uniqueId;
    let animationInstance = null;
  
    class WhyChooseUsAnimation {
      constructor(sectionId) {
        this.sectionId = sectionId;
        this.current = 0;
        this.isAnimating = false;
        this.sections = [];
        this.interval = null;
        this.isActive = false;
        this.isPaused = false;
        this.hoverContainer = null;
        this.startTime = 0;
        this.pausedProgress = 0;
        this.animationDuration = 7000;
      }
  
      init() {
        this.cleanup();
        this.findSections();
        
        if (this.sections.length > 0) {
          this.setupSections();
          this.setupEventListeners();
          this.startAnimation();
          this.isActive = true;
        }
      }
  
      findSections() {
        const container = document.querySelector(`[data-animation-section="${this.sectionId}"]`);
        if (container) {
          this.sections = Array.from(container.querySelectorAll('.section'));
          this.hoverContainer = container.querySelector(`[data-hover-container="${this.sectionId}"]`);
        }
      }
  
      setupEventListeners() {
        // Hover events for pause/resume
        if (this.hoverContainer) {
          this.hoverContainer.addEventListener('mouseenter', this.handleMouseEnter.bind(this));
          this.hoverContainer.addEventListener('mouseleave', this.handleMouseLeave.bind(this));
        }
  
        // Click events for manual navigation
        this.sections.forEach((section, index) => {
          section.addEventListener('click', this.handleSectionClick.bind(this, index));
        });
      }
  
      handleMouseEnter() {
        this.pauseAnimation();
      }
  
      handleMouseLeave() {
        this.resumeAnimation();
      }
  
      handleSectionClick(index) {
        this.goToSection(index);
      }
  
      setupSections() {
        this.sections.forEach((sec) => {
          const title = sec.querySelector('[data-title]');
          const barBg = sec.querySelector('[data-bar-bg]');
          const desc = sec.querySelector('[data-description]');
          const progress = sec.querySelector('[data-progress]');
          
          if (title && barBg) {
            barBg.style.height = `${title.offsetHeight}px`;
          }
          
          if (desc) {
            desc.classList.add('opacity-0', 'max-h-0');
            desc.classList.remove('opacity-100', 'max-h-[300px]');
          }
          
          if (progress) {
            progress.style.height = '0px';
            
          }
          
          sec.classList.add('opacity-50');
        });
  
        if (this.sections[0]) {
          this.expandSection(this.sections[0]);
        }
      }
  
      startAnimation() {
        this.stopAnimation();
        this.startTime = Date.now();
        this.pausedProgress = 0;
        
        this.interval = setInterval(() => {
          if (this.isAnimating || this.sections.length === 0) return;
          
          if (!this.isPaused) {
            const elapsed = Date.now() - this.startTime + this.pausedProgress;
            
            if (elapsed >= this.animationDuration) {
              this.advanceToNext();
            }
          }
        }, 50);
      }
  
      advanceToNext() {
        if (this.isAnimating) return;
        
        this.isAnimating = true;
        const next = (this.current + 1) % this.sections.length;
        
        this.collapseSection(this.sections[this.current])
          .then(() => this.expandSection(this.sections[next]))
          .then(() => {
            this.current = next;
            this.isAnimating = false;
            this.resetTimer();
          })
          .catch(() => {
            this.isAnimating = false;
            this.resetTimer();
          });
      }
  
      resetTimer() {
        this.startTime = Date.now();
        this.pausedProgress = 0;
      }
  
      pauseAnimation() {
        if (this.isPaused) return;
        
        this.isPaused = true;
        this.pausedProgress += Date.now() - this.startTime;
        
        // Pause the progress bar animation
        const currentSection = this.sections[this.current];
        if (currentSection) {
          const progress = currentSection.querySelector('[data-progress]');
          if (progress) {
            const computedStyle = window.getComputedStyle(progress);
            const currentHeight = computedStyle.height;
            progress.style.transition = 'none';
            progress.style.height = currentHeight;
          }
        }
      }
  
      resumeAnimation() {
        if (!this.isPaused) return;
        
        this.isPaused = false;
        this.startTime = Date.now();
        
        // Resume the progress bar animation
        const currentSection = this.sections[this.current];
        if (currentSection) {
          const progress = currentSection.querySelector('[data-progress]');
          const barBg = currentSection.querySelector('[data-bar-bg]');
          
          if (progress && barBg) {
            const totalHeight = parseInt(barBg.style.height);
            const remainingTime = this.animationDuration - this.pausedProgress;
            
            if (remainingTime > 0) {
              progress.style.transition = `height ${remainingTime}ms linear`;
              progress.style.height = `${totalHeight}px`;
            }
          }
        }
      }
  
      goToSection(index) {
        if (this.isAnimating || index === this.current || index >= this.sections.length) return;
        
        this.isAnimating = true;
        this.isPaused = false; // Ensure we're not paused after click
        
        this.collapseSection(this.sections[this.current])
          .then(() => this.expandSection(this.sections[index]))
          .then(() => {
            this.current = index;
            this.isAnimating = false;
            this.resetTimer();
          })
          .catch(() => {
            this.isAnimating = false;
            this.resetTimer();
          });
      }
  
      stopAnimation() {
        if (this.interval) {
          clearInterval(this.interval);
          this.interval = null;
        }
      }
  
      cleanup() {
        this.stopAnimation();
        this.isActive = false;
        this.isPaused = false;
        
        // Remove event listeners
        if (this.hoverContainer) {
          this.hoverContainer.removeEventListener('mouseenter', this.handleMouseEnter.bind(this));
          this.hoverContainer.removeEventListener('mouseleave', this.handleMouseLeave.bind(this));
        }
        
        this.sections.forEach((section, index) => {
          section.removeEventListener('click', this.handleSectionClick.bind(this, index));
        });
      }
  
      expandSection(section) {
        return new Promise((resolve) => {
          if (!section) {
            resolve();
            return;
          }
  
          const title = section.querySelector('[data-title]');
          const desc = section.querySelector('[data-description]');
          const progress = section.querySelector('[data-progress]');
          const barBg = section.querySelector('[data-bar-bg]');
  
          if (!title || !desc || !progress || !barBg) {
            resolve();
            return;
          }
  
          const titleHeight = title.offsetHeight;
          const descHeight = desc.scrollHeight;
          const totalHeight = titleHeight + descHeight;
  
          section.classList.remove('opacity-50');
  
          barBg.style.transition = 'height 0.3s ease-in-out';
          barBg.style.height = `${totalHeight}px`;
  
          desc.classList.remove('opacity-0', 'max-h-0');
          desc.classList.add('opacity-100', 'max-h-[300px]');
  
          progress.style.transition = 'none';
          progress.style.height = '0px';
          void progress.offsetHeight;
  
          progress.style.transition = 'height 7s linear';
          progress.style.height = `${totalHeight}px`;
  
          setTimeout(resolve, 300);
        });
      }
  
      collapseSection(section) {
        return new Promise((resolve) => {
          if (!section) {
            resolve();
            return;
          }
  
          const title = section.querySelector('[data-title]');
          const desc = section.querySelector('[data-description]');
          const progress = section.querySelector('[data-progress]');
          const barBg = section.querySelector('[data-bar-bg]');
  
          if (!title || !desc || !progress || !barBg) {
            resolve();
            return;
          }
  
          const titleHeight = title.offsetHeight;
  
          desc.classList.remove('opacity-100', 'max-h-[300px]');
          desc.classList.add('opacity-0', 'max-h-0');
  
          progress.style.transition = 'height 0.7s ease-in-out';
          progress.style.height = `${titleHeight}px`;
  
          barBg.style.transition = 'height 0.7s ease-in-out';
          barBg.style.height = `${titleHeight}px`;
  
          setTimeout(() => {
            section.classList.add('opacity-50');
            resolve();
          }, 700);
        });
      }
    }
  
    function initializeAnimation() {
      if (animationInstance) {
        animationInstance.cleanup();
      }
      
      animationInstance = new WhyChooseUsAnimation(SECTION_ID);
      
      // Use setTimeout to ensure DOM is ready
      setTimeout(() => {
        animationInstance.init();
      }, 100);
    }
  
    function cleanupAnimation() {
      if (animationInstance) {
        animationInstance.cleanup();
        animationInstance = null;
      }
    }
  
    // Event listeners for different scenarios
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initializeAnimation);
    } else {
      initializeAnimation();
    }
  
    // Astro navigation events
    document.addEventListener('astro:page-load', initializeAnimation);
    document.addEventListener('astro:after-swap', initializeAnimation);
    document.addEventListener('astro:before-preparation', cleanupAnimation);
  
    // Regular navigation cleanup
    window.addEventListener('beforeunload', cleanupAnimation);
  
    // Store cleanup function globally for manual cleanup if needed
    window[`cleanup_${SECTION_ID}`] = cleanupAnimation;
  })();
  </script>
